---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import CourseCard from "../components/CourseCard.astro";

// 1. Fetch all entries from the 'notes' collection
const allNotes = await getCollection("notes");

// 2. Sort notes by year (descending) and then by title
// This ensures 2024-2025 appears above 2023-2024
const years = [...new Set(allNotes.map((note) => note.data.year))].sort().reverse();
---


<BaseLayout title = "Notes" sideBarActiveItemID="notes">
  <div>
    <div><h1 class="text-4xl font-bold mb-5 text-primary">NOTES</h1></div>
  </div>

  <div class="mb-10">
      <p class="text-lg">
        Here are some of the notes I took during various courses, mainly in Italian. Please note that they might be incomplete or contain errors, so use them with caution. Still, you might find something useful!
      </p>
      
      <!-- Warning box
      <div class="alert alert-warning shadow-sm mt-4 bg-orange-50 border-s-4 border-orange-400 p-4">
        <div class="flex gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
          <span class="text-sm text-orange-800 italic">
            Please note that they might be incomplete or contain errors, so use them with caution. Still, you might find something useful!
          </span>
        </div>
      </div>
      -->
    </div>

    {
      years.map((year) => (
        <section class="mb-12">
          <h2 class="text-2xl font-bold border-b-2 border-primary w-fit mb-6">
            {year}
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            {allNotes
              .filter((note) => note.data.year === year)
              .map((note) => (
                <CourseCard
                  title={note.data.title}
                  professor={note.data.professor}
                  university={note.data.university}
                  url={note.data.url}
                  badge={note.data.badge}
                />
              ))}
          </div>
        </section>
      ))
    }
    
</BaseLayout>
